<div class="header-row">

    <div class="title-box">
        <h2>ALL USERS & PROFILES</h2>
        <span>Drectory / Detail View</span>
    </div>

    <input type="text" class="search-box" placeholder="Global Search......">
</div>
<div class="layout">
    <div class="header-view">
        <div class="top-veiw" *ngIf="editingmember">
            <div class="header-name">
                <h3>Member Directory</h3>
                <p class="special">1,248 Users</p>
            </div>
            <input type="text" [(ngModel)]="editingmember.name" class="Search-box1"
                placeholder="Find member by name or ID..">
            <select name="" id="" [(ngModel)]="editingmember.status">
                <option>Active</option>
                <option>Inactive</option>
                <option>Pending</option>
                <option>Expired</option>
            </select>
            <button (click)="saveMember()">Save</button>
            <button (click)="cancel()">Cancel</button>
        </div>
        <div class="status-bar">
            <span>MEMBER</span>
            <span>STATUS</span>
        </div>
        <div class="members-list">

            <div class="member-card" *ngFor="let m of members" (click)="editmember(m.id)">

                <!-- Row: Name left | Status right -->
                <div class="member-row">
                    <span class="member-name">{{ m.name }}</span>

                    <span class="member-status" [ngClass]="m.status.toLowerCase()">
                        {{ m.status }}
                    </span>
                </div>

                <!-- ID below -->
                <p class="member-id">ID: {{ m.id }}</p>
            </div>

        </div>
        <div class="bottom">
            <p>Showing {{ members.length }} of {{ totalUsers }}</p>
            <button class="filter-btn" (click)="newMember()">Add Member</button>
            <p></p>
        </div>

    </div>
    <div class="right-section">

        <!-- PROFILE CARD -->
        <div class="profile-card">

            <!-- View Mode -->
            <div *ngIf="!editMode">
                <h3>{{ user.name }}</h3>
                <p>{{ user.email }}</p>
                <p>{{user.location}}</p>
                {{user.BirthDate}}

                <button class="btn1" (click)="enableEdit()">Edit Profile</button>
            </div>

            <!-- Edit Mode -->
            <div *ngIf="editMode" class="edit-form">

                <input type="text" [(ngModel)]="editUser.name" placeholder="Full Name">
                <input type="email" [(ngModel)]="editUser.email" placeholder="Email">
                <input type="text" [(ngModel)]="editUser.location" placeholder="Email">
                <input type="text" [(ngModel)]="editUser.BirthDate" placeholder="Email">

                <div class="actions">
                    <button (click)="saveProfile()">Save</button>
                    <button class="cancel" (click)="cancelEdit()">Cancel</button>
                </div>
            </div>
        </div>
        <div class="membership-card">

            <h3>Membership Details</h3>

            <div class="grid">

                <div>
                    <label>Plan Type</label>
                    <!-- <input type="text" [(ngModel)]="member.planType"> -->
                    <select name="" id="" [(ngModel)]="member.planType" (change)="setEndDate()">
                        <option>Basic-1 Month</option>
                        <option>Basic-3 Months</option>
                        <option>Basic-6 Months</option>
                        <option>Basic-12 Months</option>
                        <option>Premium-1 Month</option>
                        <option>Premium-12 Months</option>
                    </select>
                </div>

                <div>
                    <label>Start Date</label>
                    <input type="date" [(ngModel)]="member.startDate" (ngModelChange)="setEndDate()">
                </div>

                <div>
                    <label>End Date</label>
                    <input type="date" [(ngModel)]="member.endDate" (change)="updateExpiryBadge()">
                </div>

                <div>
                    <label>Payment Status</label>
                    <select [(ngModel)]="member.paymentStatus">
                        <option value="Paid">Paid</option>
                        <option value="Due">Due</option>
                        <option value="Pending">Pending</option>
                    </select>
                </div>

                <div>
                    <label>
                        <input type="checkbox" [(ngModel)]="member.renewalReminder">
                        Renewal Reminder
                    </label>
                </div>
                <button (click)="saveMembership()">Save MemberShip</button>

            </div>
            <div *ngIf="savedMember" class="profile-display">

                <h3>Membership Summary</h3>

                <p><strong>Plan:</strong> {{ savedMember.planType }}</p>
                <p><strong>Start:</strong> {{ savedMember.startDate }}</p>
                <p><strong>End:</strong> {{ savedMember.endDate }}</p>
                <p><strong>Payment:</strong> {{ savedMember.paymentStatus }}</p>
                <p><strong>Trainer:</strong>{{member.trainerName|| 'Not Assigned'}}</p>

                <span class="badge" [ngClass]="{
          'expired': member.statusBadge === 'Expired',
          'warning': member.statusBadge.includes('Expires'),
          'active': member.statusBadge.includes('Active')
  }">
                    {{ member.statusBadge }}
                </span>

            </div>
            <h3>Health & Personal Details</h3>

            <div *ngIf="savedMember" class="profile-display">

                <h3>Health Summary</h3>

                <p><strong>Height:</strong> {{ savedMember.height }} cm</p>
                <p><strong>Weight:</strong> {{ savedMember.weight }} kg</p>
                <p><strong>BMI:</strong> {{ savedMember.bmi }}</p>
                <p><strong>Body Fat:</strong> {{ savedMember.bodyFat }} %</p>

                <p><strong>Medical Conditions:</strong>
                    {{ savedMember.medicalConditions || 'None' }}
                </p>

                <p><strong>Injuries:</strong>
                    {{ savedMember.injuries || 'None' }}
                </p>

                <p><strong>Diet Preference:</strong>
                    {{ savedMember.dietPreference }}
                </p>

            </div>

            <hr>

            <h3>Trainer / Coach Assignment</h3>

            <div class="grid">
                <div>
                    <label>Assigned Trainer</label>
                    <select [(ngModel)]="member.trainerName">
                        <option value="">Select Trainer</option>

                        <option *ngFor="let t of trainers" [disabled]="getTrainerStatus(t) === 'Full'">

                            {{t.name}} —
                            {{ getTrainerStatus(t) }}
                            ({{t.assigned}} / {{t.capacity}})
                        </option>
                    </select>
                </div>

                <button (click)="changeTrainer('Not Assigned Trainer')">
                    Change Trainer
                </button>
                <button (click)="assignTrainer()">Confirm Trainer</button>
            </div>

            <hr>
            <h3>Health & Personal Details</h3>

            <div class="grid">

                <div>
                    <label>Height (cm)</label>
                    <input type="number" [(ngModel)]="member.height" (change)="calculateBMI()">
                </div>

                <div>
                    <label>Weight (kg)</label>
                    <input type="number" [(ngModel)]="member.weight" (change)="calculateBMI()">
                </div>

                <div>
                    <label>BMI</label>
                    <input type="number" [(ngModel)]="member.bmi" disabled>
                </div>

                <div>
                    <label>Body Fat %</label>
                    <input type="number" [(ngModel)]="member.bodyFat">
                </div>

                <div class="full">
                    <label>Medical Conditions</label>
                    <textarea rows="2" [(ngModel)]="member.medicalConditions"></textarea>
                </div>

                <div class="full">
                    <label>Injuries</label>
                    <textarea rows="2" [(ngModel)]="member.injuries"></textarea>
                </div>

                <div>
                    <label>Diet Preference</label>
                    <select [(ngModel)]="member.dietPreference">
                        <option>Veg</option>
                        <option>Non-veg</option>
                        <option>none</option>
                    </select>
                </div>

            </div>

            <button (click)="saveMembership()">Save Health Details</button>

        </div>
        <!-- SUGGESTION BOX -->
        <div class="suggestion-box">
            <h4>Smart Optimization Suggestion</h4>
            <h6>Real-Time</h6>
            <p class="color-change">
                Sarah usually does cardio at this time . the <strong>Treadmill Zone</strong> is currently at <strong
                    style="color: red;">95% capacity</strong> . Basec on her history. she also enjoys rowing. <strong
                    style="color: green;">Rowing Machines</strong>
                are 80% free.
                Suggest switching to maintain heart rate target without wait </p>
            <span class="note">Notify User</span>
        </div>

        <!-- STATS ROW -->
        <div class="stats-row">
            <div class="stat-card">
                <span>Attendance (MO)</span>
                <h2>{{attendence}}</h2>
                <p style="color: green;">+2</p>
                <div class="container">
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" aria-valuenow="70" aria-valuemin="0"
                            aria-valuemax="100" style="width:84%">
                            <span class="sr-only">98% Complete</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stat-card">
                <span>Avg. Duration</span>
                <h2>55 <h6>min</h6>
                </h2>
                <p>Consistent</p>
            </div>

            <div class="stat-card">
                <span>Current Streak</span>
                <h2>{{currentStreak}}<h6>Days</h6>
                </h2>
                <p>Personal Best:12 Days</p>
            </div>

            <div class="stat-card">
                <span>Progress Goal</span>
                <h2>{{progressGoal}}</h2>
                <div class="container">
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" aria-valuenow="70" aria-valuemin="0"
                            aria-valuemax="100" style=" background-color: #d63384;" [style.width.%]="progressGoal">
                            <span class="sr-only">82% Complete</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- LOWER SECTION -->
        <div class="two-panel">
            <div class="attendance-card">

                <div class="card-head">
                    <h4>Attendance & Preferred Times</h4>
                    <span class="dot-badge">● Workouts</span>
                </div>
                <div style="height: 160px;" class="chart-box">
                    <canvas id="attendanceChart"></canvas>
                </div>


                <div class="peak-box">
                    <span class="peak-title">Peak Performance Time</span>
                    <p>Sarah trains best between 5 PM - 7 PM</p>
                </div>

            </div>
            <div class="final-card">

                <div class="card-top">
                    <h4>WorkOut Focus & Equipment</h4>
                </div>

                <!-- Row 1 -->
                <div class="row">
                    <p>Cardio (Treadmill / Rowing)</p>

                    <div class="bar">
                        <div class="container">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuenow="70" aria-valuemin="0"
                                    aria-valuemax="100" style="width:45% ">
                                    <span class="sr-only">45%Complete</span>
                                </div>
                            </div>
                        </div>
                        <span class="percent">45%</span>
                    </div>
                </div>

                <!-- Row 2 -->
                <div class="row">
                    <p>Strength (Free Weight)</p>

                    <div class="bar">
                        <div class="container">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuenow="70" aria-valuemin="0"
                                    aria-valuemax="100" style="width:30% ; background-color: #d712ba;">

                                </div>
                            </div>
                        </div>
                        <span class="percent">30%</span>
                    </div>
                </div>

                <!-- Row 3 -->
                <div class="row">
                    <p>Flexibility (Yoga / Mat)</p>

                    <div class="bar">
                        <div class="container">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuenow="70" aria-valuemin="0"
                                    aria-valuemax="100" style="width:25% ;background-color: green;">
                                    <span class="sr-only">25%Complete</span>
                                </div>
                            </div>
                        </div>
                        <span class="percent">25%</span>
                    </div>
                </div>
                <div class="btns">
                    <button>Fav:Leg Press</button>
                    <button>Fav:Elliptical</button>
                </div>

            </div>


        </div>


    </div>
</div>